---
paths:
  - "thesis/**"
  - "analysis/**/*.R"
  - "figures/**"
  - "tables/**"
---

# Single Source of Truth: Enforcement Protocol

## The SSOT Chain

```
thesis/论文_word版.docx (SOURCE OF TRUTH for prose)
  ├── Claude outputs → Word-pasteable paragraphs (derived, user pastes manually)
  ├── figures/ → all figure files (script-generated, NEVER hand-edited)
  └── tables/ → all table files (script-generated)

analysis/*.R scripts (SOURCE OF TRUTH for analysis)
  ├── figures/ → output (derived)
  ├── tables/ → output (derived)
  └── data/processed/ → intermediate RDS objects (derived)

Bibliography_base.bib (SOURCE OF TRUTH for references)

.claude/rules/knowledge-base-template.md (SOURCE OF TRUTH for terminology)

NEVER edit derived artifacts independently.
ALWAYS propagate changes from source → derived.
```

---

## Key Rules

1. **Claude NEVER directly edits `thesis/论文_word版.docx`** -- it outputs plain text with chapter location headers for the user to paste
2. **Figures NEVER hand-edited** -- all figures must be generated by R scripts in `analysis/`
3. **Terminology consistency** -- all terms follow `knowledge-base-template.md`; if a discrepancy is found, the knowledge base is authoritative
4. **Statistics traceability** -- every number in the thesis must trace back to a script output

---

## Content Fidelity Checklist

```
[ ] Every figure in the thesis has a corresponding script in analysis/
[ ] Every statistical claim in the thesis has a corresponding script output
[ ] Figure legends match the script parameters (n, thresholds, methods)
[ ] All terminology matches knowledge-base-template.md
[ ] Citation keys in thesis match Bibliography_base.bib entries
[ ] No hand-edited figures exist in figures/ directory
[ ] All R scripts produce identical output when re-run (set.seed)
```
